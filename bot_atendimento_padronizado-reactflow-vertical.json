{
  "edges": [
    {
      "id": "e0_boas_vindas_hsm_delay_inicial",
      "source": "boas_vindas_hsm",
      "target": "delay_inicial",
      "type": "default",
      "data": {
        "guard": "flow.hsm_sent == true",
        "label": "success",
        "priority": 1
      },
      "animated": false,
      "deletable": true,
      "selectable": true,
      "label": "success",
      "markerEnd": "arrowclosed"
    },
    {
      "id": "e1_boas_vindas_hsm_apresentacao_imagem",
      "source": "boas_vindas_hsm",
      "target": "apresentacao_imagem",
      "type": "default",
      "data": {
        "guard": "flow.hsm_sent == false",
        "label": "fallback",
        "priority": 2
      },
      "animated": true,
      "deletable": true,
      "selectable": true,
      "label": "fallback",
      "markerEnd": "arrowclosed"
    },
    {
      "id": "e2_boas_vindas_hsm_timeout_handler",
      "source": "boas_vindas_hsm",
      "target": "timeout_handler",
      "type": "step",
      "data": {
        "guard": "flow.timeout == true",
        "label": "timeout",
        "priority": 3
      },
      "animated": true,
      "deletable": true,
      "selectable": true,
      "label": "timeout",
      "markerEnd": "arrow"
    },
    {
      "id": "e3_delay_inicial_apresentacao_imagem",
      "source": "delay_inicial",
      "target": "apresentacao_imagem",
      "type": "default",
      "data": {
        "label": "complete"
      },
      "animated": false,
      "deletable": true,
      "selectable": true,
      "label": "complete",
      "markerEnd": "arrowclosed"
    },
    {
      "id": "e4_apresentacao_imagem_menu_principal",
      "source": "apresentacao_imagem",
      "target": "menu_principal",
      "type": "default",
      "data": {
        "guard": "flow.media_sent == true",
        "label": "sent"
      },
      "animated": false,
      "deletable": true,
      "selectable": true,
      "label": "sent",
      "markerEnd": "arrowclosed"
    },
    {
      "id": "e5_apresentacao_imagem_menu_principal",
      "source": "apresentacao_imagem",
      "target": "menu_principal",
      "type": "default",
      "data": {
        "guard": "flow.media_sent == false",
        "label": "failed"
      },
      "animated": false,
      "deletable": true,
      "selectable": true,
      "label": "failed",
      "markerEnd": "arrowclosed"
    },
    {
      "id": "e6_menu_principal_especialidades_lista",
      "source": "menu_principal",
      "target": "especialidades_lista",
      "type": "default",
      "data": {
        "guard": "payload == 'agendar'",
        "label": "btn_agendar"
      },
      "animated": false,
      "deletable": true,
      "selectable": true,
      "label": "btn_agendar",
      "markerEnd": "arrowclosed"
    },
    {
      "id": "e7_menu_principal_meus_agendamentos",
      "source": "menu_principal",
      "target": "meus_agendamentos",
      "type": "default",
      "data": {
        "guard": "payload == 'agendamentos'",
        "label": "btn_agendamentos"
      },
      "animated": false,
      "deletable": true,
      "selectable": true,
      "label": "btn_agendamentos",
      "markerEnd": "arrowclosed"
    },
    {
      "id": "e8_menu_principal_carousel_planos",
      "source": "menu_principal",
      "target": "carousel_planos",
      "type": "default",
      "data": {
        "guard": "payload == 'planos'",
        "label": "btn_planos"
      },
      "animated": false,
      "deletable": true,
      "selectable": true,
      "label": "btn_planos",
      "markerEnd": "arrowclosed"
    },
    {
      "id": "e9_menu_principal_timeout_handler",
      "source": "menu_principal",
      "target": "timeout_handler",
      "type": "step",
      "data": {
        "guard": "flow.timeout == true",
        "label": "timeout"
      },
      "animated": true,
      "deletable": true,
      "selectable": true,
      "label": "timeout",
      "markerEnd": "arrow"
    },
    {
      "id": "e10_menu_principal_fallback_handler",
      "source": "menu_principal",
      "target": "fallback_handler",
      "type": "step",
      "data": {
        "guard": "flow.invalid_input == true",
        "label": "invalid"
      },
      "animated": true,
      "deletable": true,
      "selectable": true,
      "label": "invalid",
      "markerEnd": "arrow"
    },
    {
      "id": "e11_especialidades_lista_delay_processamento",
      "source": "especialidades_lista",
      "target": "delay_processamento",
      "type": "default",
      "data": {
        "guard": "flow.especialidade_selected == true",
        "label": "especialidade_selected"
      },
      "animated": false,
      "deletable": true,
      "selectable": true,
      "label": "especialidade_selected",
      "markerEnd": "arrowclosed"
    },
    {
      "id": "e12_especialidades_lista_timeout_handler",
      "source": "especialidades_lista",
      "target": "timeout_handler",
      "type": "default",
      "data": {
        "label": "timeout"
      },
      "animated": true,
      "deletable": true,
      "selectable": true,
      "label": "timeout",
      "markerEnd": "arrowclosed"
    },
    {
      "id": "e13_especialidades_lista_fallback_handler",
      "source": "especialidades_lista",
      "target": "fallback_handler",
      "type": "default",
      "data": {
        "label": "invalid"
      },
      "animated": true,
      "deletable": true,
      "selectable": true,
      "label": "invalid",
      "markerEnd": "arrowclosed"
    },
    {
      "id": "e14_delay_processamento_horarios_lista",
      "source": "delay_processamento",
      "target": "horarios_lista",
      "type": "default",
      "data": {
        "label": "complete"
      },
      "animated": false,
      "deletable": true,
      "selectable": true,
      "label": "complete",
      "markerEnd": "arrowclosed"
    },
    {
      "id": "e15_horarios_lista_agendamento_confirmacao",
      "source": "horarios_lista",
      "target": "agendamento_confirmacao",
      "type": "default",
      "data": {
        "guard": "flow.horario_selected == true",
        "label": "horario_selected"
      },
      "animated": false,
      "deletable": true,
      "selectable": true,
      "label": "horario_selected",
      "markerEnd": "arrowclosed"
    },
    {
      "id": "e16_horarios_lista_timeout_handler",
      "source": "horarios_lista",
      "target": "timeout_handler",
      "type": "default",
      "data": {
        "label": "timeout"
      },
      "animated": true,
      "deletable": true,
      "selectable": true,
      "label": "timeout",
      "markerEnd": "arrowclosed"
    },
    {
      "id": "e17_agendamento_confirmacao_delay_processamento_agendamento",
      "source": "agendamento_confirmacao",
      "target": "delay_processamento_agendamento",
      "type": "default",
      "data": {
        "guard": "payload == 'confirmar_agendamento'",
        "label": "btn_confirmar"
      },
      "animated": false,
      "deletable": true,
      "selectable": true,
      "label": "btn_confirmar",
      "markerEnd": "arrowclosed"
    },
    {
      "id": "e18_agendamento_confirmacao_menu_principal",
      "source": "agendamento_confirmacao",
      "target": "menu_principal",
      "type": "default",
      "data": {
        "guard": "payload == 'cancelar_agendamento'",
        "label": "btn_cancelar"
      },
      "animated": false,
      "deletable": true,
      "selectable": true,
      "label": "btn_cancelar",
      "markerEnd": "arrowclosed"
    },
    {
      "id": "e19_agendamento_confirmacao_timeout_handler",
      "source": "agendamento_confirmacao",
      "target": "timeout_handler",
      "type": "default",
      "data": {
        "label": "timeout"
      },
      "animated": true,
      "deletable": true,
      "selectable": true,
      "label": "timeout",
      "markerEnd": "arrowclosed"
    },
    {
      "id": "e20_delay_processamento_agendamento_comprovante_documento",
      "source": "delay_processamento_agendamento",
      "target": "comprovante_documento",
      "type": "default",
      "data": {
        "label": "complete"
      },
      "animated": false,
      "deletable": true,
      "selectable": true,
      "label": "complete",
      "markerEnd": "arrowclosed"
    },
    {
      "id": "e21_comprovante_documento_finalizar_atendimento",
      "source": "comprovante_documento",
      "target": "finalizar_atendimento",
      "type": "default",
      "data": {
        "label": "sent"
      },
      "animated": false,
      "deletable": true,
      "selectable": true,
      "label": "sent",
      "markerEnd": "arrowclosed"
    },
    {
      "id": "e22_comprovante_documento_finalizar_atendimento",
      "source": "comprovante_documento",
      "target": "finalizar_atendimento",
      "type": "default",
      "data": {
        "label": "failed"
      },
      "animated": false,
      "deletable": true,
      "selectable": true,
      "label": "failed",
      "markerEnd": "arrowclosed"
    },
    {
      "id": "e23_carousel_planos_finalizar_atendimento",
      "source": "carousel_planos",
      "target": "finalizar_atendimento",
      "type": "default",
      "data": {
        "label": "plano_selected"
      },
      "animated": false,
      "deletable": true,
      "selectable": true,
      "label": "plano_selected",
      "markerEnd": "arrowclosed"
    },
    {
      "id": "e24_carousel_planos_timeout_handler",
      "source": "carousel_planos",
      "target": "timeout_handler",
      "type": "default",
      "data": {
        "label": "timeout"
      },
      "animated": true,
      "deletable": true,
      "selectable": true,
      "label": "timeout",
      "markerEnd": "arrowclosed"
    },
    {
      "id": "e25_meus_agendamentos_finalizar_atendimento",
      "source": "meus_agendamentos",
      "target": "finalizar_atendimento",
      "type": "default",
      "data": {
        "label": "complete"
      },
      "animated": false,
      "deletable": true,
      "selectable": true,
      "label": "complete",
      "markerEnd": "arrowclosed"
    },
    {
      "id": "e26_informacoes_clinica_finalizar_atendimento",
      "source": "informacoes_clinica",
      "target": "finalizar_atendimento",
      "type": "default",
      "data": {
        "label": "btn_localizacao"
      },
      "animated": false,
      "deletable": true,
      "selectable": true,
      "label": "btn_localizacao",
      "markerEnd": "arrowclosed"
    },
    {
      "id": "e27_informacoes_clinica_finalizar_atendimento",
      "source": "informacoes_clinica",
      "target": "finalizar_atendimento",
      "type": "default",
      "data": {
        "label": "btn_site"
      },
      "animated": false,
      "deletable": true,
      "selectable": true,
      "label": "btn_site",
      "markerEnd": "arrowclosed"
    },
    {
      "id": "e28_informacoes_clinica_finalizar_atendimento",
      "source": "informacoes_clinica",
      "target": "finalizar_atendimento",
      "type": "default",
      "data": {
        "label": "btn_ligar"
      },
      "animated": false,
      "deletable": true,
      "selectable": true,
      "label": "btn_ligar",
      "markerEnd": "arrowclosed"
    },
    {
      "id": "e29_timeout_handler_menu_principal",
      "source": "timeout_handler",
      "target": "menu_principal",
      "type": "default",
      "data": {
        "guard": "payload == 'menu'",
        "label": "menu"
      },
      "animated": false,
      "deletable": true,
      "selectable": true,
      "label": "menu",
      "markerEnd": "arrowclosed"
    },
    {
      "id": "e30_timeout_handler_finalizar_atendimento",
      "source": "timeout_handler",
      "target": "finalizar_atendimento",
      "type": "default",
      "data": {
        "guard": "payload == 'human'",
        "label": "human"
      },
      "animated": false,
      "deletable": true,
      "selectable": true,
      "label": "human",
      "markerEnd": "arrowclosed"
    },
    {
      "id": "e31_timeout_handler_finalizar_atendimento",
      "source": "timeout_handler",
      "target": "finalizar_atendimento",
      "type": "default",
      "data": {
        "label": "timeout_final"
      },
      "animated": false,
      "deletable": true,
      "selectable": true,
      "label": "timeout_final",
      "markerEnd": "arrowclosed"
    },
    {
      "id": "e32_fallback_handler_menu_principal",
      "source": "fallback_handler",
      "target": "menu_principal",
      "type": "step",
      "data": {
        "guard": "flow.fallback_attempts \u003c 3",
        "label": "retry"
      },
      "animated": false,
      "deletable": true,
      "selectable": true,
      "label": "retry",
      "markerEnd": "arrow"
    },
    {
      "id": "e33_fallback_handler_finalizar_atendimento",
      "source": "fallback_handler",
      "target": "finalizar_atendimento",
      "type": "step",
      "data": {
        "guard": "flow.fallback_attempts \u003e= 3",
        "label": "escalate"
      },
      "animated": false,
      "deletable": true,
      "selectable": true,
      "label": "escalate",
      "markerEnd": "arrow"
    }
  ],
  "layout": {
    "applied": true,
    "direction": "vertical"
  },
  "nodes": [
    {
      "id": "boas_vindas_hsm",
      "type": "message",
      "data": {
        "final": false,
        "kind": "message",
        "props": {
          "delay": {
            "after": 2000,
            "reason": "Simular digita√ß√£o",
            "show_typing": true
          },
          "hsm": {
            "name": "welcome_clinic_template"
          },
          "timeout": {
            "action": "retry",
            "duration": 30,
            "max_attempts": 2,
            "message": "Ol√°! Bem-vindo √† {{props.clinica_nome}}! üè•"
          }
        },
        "title": "Boas-vindas HSM"
      },
      "position": {
        "x": 100,
        "y": 100
      },
      "width": 280,
      "height": 80,
      "draggable": true,
      "selectable": true,
      "deletable": true,
      "sourcePosition": "right",
      "targetPosition": "left"
    },
    {
      "id": "apresentacao_imagem",
      "type": "media",
      "data": {
        "final": false,
        "kind": "media",
        "props": {
          "alt_text": "Fachada da Cl√≠nica Sa√∫de \u0026 Bem-Estar",
          "caption": "Bem-vindo √† {{props.clinica_nome}}! üè•\n\nEstamos aqui para cuidar da sua sa√∫de com excel√™ncia.",
          "dimensions": {
            "max_height": 1080,
            "max_width": 1920
          },
          "size_limit": "5MB",
          "type": "image",
          "url": "https://example.com/images/clinica-fachada.jpg",
          "validation": {
            "fallback_text": "üè• Bem-vindo √† {{props.clinica_nome}}!\n\nEstamos aqui para cuidar da sua sa√∫de com excel√™ncia.",
            "max_attempts": 2,
            "on_invalid": "retry"
          }
        },
        "title": "Imagem da Cl√≠nica"
      },
      "position": {
        "x": 100,
        "y": 220
      },
      "width": 300,
      "height": 120,
      "draggable": true,
      "selectable": true,
      "deletable": true,
      "sourcePosition": "right",
      "targetPosition": "left"
    },
    {
      "id": "menu_principal",
      "type": "buttons",
      "data": {
        "final": false,
        "kind": "buttons",
        "props": {
          "buttons": [
            {
              "id": "btn_agendar",
              "kind": "reply",
              "label": "üìÖ Agendar",
              "payload": "agendar",
              "position": 1
            },
            {
              "id": "btn_agendamentos",
              "kind": "reply",
              "label": "üìã Agendamentos",
              "payload": "agendamentos",
              "position": 2
            },
            {
              "id": "btn_planos",
              "kind": "reply",
              "label": "üõçÔ∏è Planos",
              "payload": "planos",
              "position": 3
            }
          ],
          "footer": "Responda em at√© 5 minutos",
          "header": "Menu de Atendimento",
          "text": "Ol√°! üëã\n\nComo posso ajud√°-lo hoje?\n\nüìã Escolha uma das op√ß√µes abaixo:",
          "timeout": {
            "action": "retry",
            "duration": 60,
            "max_attempts": 2
          },
          "validation": {
            "fallback_text": "Digite:\n1Ô∏è‚É£ Para agendar consulta\n2Ô∏è‚É£ Para ver agendamentos\n3Ô∏è‚É£ Para conhecer planos",
            "max_attempts": 2,
            "on_invalid": "retry"
          }
        },
        "title": "Menu Principal"
      },
      "position": {
        "x": 100,
        "y": 380
      },
      "width": 350,
      "height": 200,
      "draggable": true,
      "selectable": true,
      "deletable": true,
      "sourcePosition": "right",
      "targetPosition": "left"
    },
    {
      "id": "especialidades_lista",
      "type": "listpicker",
      "data": {
        "final": false,
        "kind": "listpicker",
        "props": {
          "button_text": "Ver especialidades",
          "fallback": {
            "parse_mode": "numbered_list",
            "text": "Digite o n√∫mero da especialidade:\n1. Cl√≠nico Geral\n2. Check-up\n3. Cardiologia\n4. Dermatologia\n5. Ortopedia",
            "timeout": 120
          },
          "footer": "Escolha uma especialidade",
          "max_selections": 1,
          "sections": [
            {
              "id": "clinica_geral_section",
              "items": [
                {
                  "description": "Consulta geral - 30 min",
                  "id": "clinico_geral",
                  "metadata": {
                    "disponivel": true,
                    "duracao": 30,
                    "valor": 120
                  },
                  "payload": "especialidade:clinico_geral",
                  "title": "Cl√≠nico Geral"
                },
                {
                  "description": "Avalia√ß√£o completa - 60 min",
                  "id": "checkup",
                  "metadata": {
                    "disponivel": true,
                    "duracao": 60,
                    "valor": 250
                  },
                  "payload": "especialidade:checkup",
                  "title": "Check-up Completo"
                }
              ],
              "title": "ü©∫ Cl√≠nica Geral"
            },
            {
              "id": "especialidades_section",
              "items": [
                {
                  "description": "Dr. Jo√£o Silva - 45 min",
                  "id": "cardiologia",
                  "metadata": {
                    "disponivel": true,
                    "duracao": 45,
                    "medico": "Dr. Jo√£o Silva",
                    "valor": 180
                  },
                  "payload": "especialidade:cardiologia",
                  "title": "Cardiologia"
                },
                {
                  "description": "Dra. Maria Santos - 30 min",
                  "id": "dermatologia",
                  "metadata": {
                    "disponivel": false,
                    "duracao": 30,
                    "medico": "Dra. Maria Santos",
                    "valor": 150
                  },
                  "payload": "especialidade:dermatologia",
                  "title": "Dermatologia"
                },
                {
                  "description": "Dr. Pedro Costa - 40 min",
                  "id": "ortopedia",
                  "metadata": {
                    "disponivel": true,
                    "duracao": 40,
                    "medico": "Dr. Pedro Costa",
                    "valor": 170
                  },
                  "payload": "especialidade:ortopedia",
                  "title": "Ortopedia"
                }
              ],
              "title": "ü¶∑ Especialidades"
            }
          ],
          "text": "üìã Selecione a especialidade para agendar sua consulta:"
        },
        "title": "Lista de Especialidades"
      },
      "position": {
        "x": 500,
        "y": 480
      },
      "width": 400,
      "height": 350,
      "draggable": true,
      "selectable": true,
      "deletable": true,
      "sourcePosition": "right",
      "targetPosition": "left"
    },
    {
      "id": "delay_processamento",
      "type": "delay",
      "data": {
        "final": false,
        "kind": "delay",
        "props": {
          "duration": 3000,
          "message": "üîÑ Verificando disponibilidade...",
          "reason": "Verificando disponibilidade",
          "show_typing": true,
          "unit": "milliseconds"
        },
        "title": "Processando..."
      },
      "position": {
        "x": 500,
        "y": 880
      },
      "width": 250,
      "height": 80,
      "draggable": true,
      "selectable": true,
      "deletable": true,
      "sourcePosition": "right",
      "targetPosition": "left"
    },
    {
      "id": "horarios_lista",
      "type": "listpicker",
      "data": {
        "final": false,
        "kind": "listpicker",
        "props": {
          "button_text": "Ver hor√°rios",
          "fallback": {
            "error_message": "Hor√°rio inv√°lido. Use formato HH:MM entre 08:00-11:59 ou 14:00-17:59",
            "text": "Digite o hor√°rio desejado (formato HH:MM):",
            "validation": "^(0[8-9]|1[0-1]|1[4-7]):[0-5][0-9]$"
          },
          "sections": [
            {
              "id": "manha_section",
              "items": [
                {
                  "description": "Dispon√≠vel",
                  "id": "08h00",
                  "payload": "horario:08:00",
                  "title": "08:00"
                },
                {
                  "description": "Dispon√≠vel",
                  "id": "09h30",
                  "payload": "horario:09:30",
                  "title": "09:30"
                },
                {
                  "description": "Ocupado",
                  "disabled": true,
                  "id": "11h00",
                  "payload": "horario:11:00",
                  "title": "11:00"
                }
              ],
              "title": "üåÖ Manh√£"
            },
            {
              "id": "tarde_section",
              "items": [
                {
                  "description": "Dispon√≠vel",
                  "id": "14h00",
                  "payload": "horario:14:00",
                  "title": "14:00"
                },
                {
                  "description": "Dispon√≠vel",
                  "id": "15h30",
                  "payload": "horario:15:30",
                  "title": "15:30"
                },
                {
                  "description": "√öltima vaga",
                  "id": "17h00",
                  "payload": "horario:17:00",
                  "title": "17:00"
                }
              ],
              "title": "üåá Tarde"
            }
          ],
          "text": "üïê Hor√°rios dispon√≠veis para {{flow.especialidade_selecionada}}:"
        },
        "title": "Sele√ß√£o de Hor√°rios"
      },
      "position": {
        "x": 500,
        "y": 1000
      },
      "width": 380,
      "height": 300,
      "draggable": true,
      "selectable": true,
      "deletable": true,
      "sourcePosition": "right",
      "targetPosition": "left"
    },
    {
      "id": "agendamento_confirmacao",
      "type": "confirm",
      "data": {
        "final": false,
        "kind": "confirm",
        "props": {
          "description": "Confirme os dados do seu agendamento antes de prosseguir.",
          "fallback": {
            "no_keywords": [
              "n√£o",
              "nao",
              "n",
              "no",
              "cancelar"
            ],
            "text": "Digite 'SIM' para confirmar ou 'N√ÉO' para cancelar:",
            "yes_keywords": [
              "sim",
              "s",
              "yes",
              "y",
              "confirmar",
              "ok"
            ]
          },
          "footer": "Responda em at√© 5 minutos",
          "header": "Confirma√ß√£o Necess√°ria",
          "no": {
            "id": "btn_cancelar",
            "payload": "cancelar_agendamento",
            "text": "‚ùå Cancelar"
          },
          "timeout": 300,
          "title": "üìÖ Confirmar agendamento?",
          "yes": {
            "id": "btn_confirmar",
            "payload": "confirmar_agendamento",
            "text": "‚úÖ Confirmar"
          }
        },
        "title": "Confirma√ß√£o de Agendamento"
      },
      "position": {
        "x": 950,
        "y": 480
      },
      "width": 350,
      "height": 180,
      "draggable": true,
      "selectable": true,
      "deletable": true,
      "sourcePosition": "right",
      "targetPosition": "left"
    },
    {
      "id": "delay_processamento_agendamento",
      "type": "delay",
      "data": {
        "final": false,
        "kind": "delay",
        "props": {
          "duration": 5000,
          "message": "üíæ Salvando seu agendamento...",
          "reason": "Salvando agendamento no sistema",
          "show_typing": true,
          "unit": "milliseconds"
        },
        "title": "Processando Agendamento"
      },
      "position": {
        "x": 950,
        "y": 700
      },
      "width": 280,
      "height": 80,
      "draggable": true,
      "selectable": true,
      "deletable": true,
      "sourcePosition": "right",
      "targetPosition": "left"
    },
    {
      "id": "comprovante_documento",
      "type": "media",
      "data": {
        "final": false,
        "kind": "media",
        "props": {
          "caption": "üìÑ Aqui est√° seu comprovante de agendamento!\n\n‚úÖ Agendamento confirmado\nüìÖ Data: {{flow.data_selecionada}}\nüïê Hor√°rio: {{flow.horario_selecionado}}\nüè• Local: {{props.clinica_nome}}\n\nüí° Chegue 15 minutos antes do hor√°rio.",
          "fallback": {
            "reason": "Falha no envio do PDF",
            "text": "üìÑ Comprovante de Agendamento\n\n‚úÖ Confirmado para {{flow.data_selecionada}} √†s {{flow.horario_selecionado}}\nüè• {{props.clinica_nome}}\n\nüìß Comprovante enviado por email tamb√©m."
          },
          "filename": "comprovante-agendamento-{{user.id}}-{{flow.timestamp}}.pdf",
          "size_limit": "10MB",
          "type": "document",
          "url": "https://example.com/docs/comprovante-agendamento.pdf"
        },
        "title": "Envio de Comprovante"
      },
      "position": {
        "x": 950,
        "y": 820
      },
      "width": 320,
      "height": 140,
      "draggable": true,
      "selectable": true,
      "deletable": true,
      "sourcePosition": "right",
      "targetPosition": "left"
    },
    {
      "id": "carousel_planos",
      "type": "carousel",
      "data": {
        "final": false,
        "kind": "carousel",
        "props": {
          "cards": [
            {
              "buttons": [
                {
                  "id": "contratar_basico",
                  "kind": "reply",
                  "label": "üí∞ Contratar",
                  "payload": "contratar:basico"
                },
                {
                  "id": "info_basico",
                  "kind": "reply",
                  "label": "‚ÑπÔ∏è Saiba mais",
                  "payload": "info:basico"
                }
              ],
              "description": "Consultas mensais + exames b√°sicos\n\n‚úÖ 2 consultas/m√™s\n‚úÖ Exames laboratoriais\n‚úÖ Desconto em medicamentos",
              "id": "plano_basico",
              "media_url": "https://example.com/images/plano-basico.jpg",
              "metadata": {
                "categoria": "basico",
                "consultas_mes": 2,
                "promocao": false
              },
              "price": "R$ 89,90/m√™s",
              "title": "Plano B√°sico"
            },
            {
              "buttons": [
                {
                  "id": "contratar_premium",
                  "kind": "reply",
                  "label": "üíé Contratar",
                  "payload": "contratar:premium"
                },
                {
                  "id": "beneficios_premium",
                  "kind": "reply",
                  "label": "üìã Benef√≠cios",
                  "payload": "beneficios:premium"
                }
              ],
              "description": "Consultas ilimitadas + exames + especialistas\n\n‚úÖ Consultas ilimitadas\n‚úÖ Todos os exames\n‚úÖ Especialistas inclusos\n‚úÖ Telemedicina",
              "id": "plano_premium",
              "media_url": "https://example.com/images/plano-premium.jpg",
              "metadata": {
                "categoria": "premium",
                "consultas_mes": -1,
                "desconto": 20,
                "promocao": true
              },
              "price": "R$ 159,90/m√™s",
              "title": "Plano Premium"
            }
          ],
          "fallback": {
            "parse_mode": "numbered_list",
            "text": "üìã Nossos Planos:\n\n1Ô∏è‚É£ B√°sico - R$ 89,90/m√™s\n2Ô∏è‚É£ Premium - R$ 159,90/m√™s\n\nDigite o n√∫mero do plano de interesse:"
          },
          "layout": "horizontal",
          "max_cards_display": 3,
          "text": "üõçÔ∏è Conhe√ßa nossos planos e servi√ßos especiais:"
        },
        "title": "Carrossel de Planos"
      },
      "position": {
        "x": 100,
        "y": 720
      },
      "width": 450,
      "height": 300,
      "draggable": true,
      "selectable": true,
      "deletable": true,
      "sourcePosition": "right",
      "targetPosition": "left"
    },
    {
      "id": "meus_agendamentos",
      "type": "message",
      "data": {
        "final": false,
        "kind": "message",
        "props": {
          "fallback": {
            "condition": "user.agendamentos.length == 0",
            "text": "üìã Voc√™ n√£o possui agendamentos no momento.\n\nüìÖ Gostaria de agendar uma consulta?"
          },
          "parse_mode": "markdown",
          "text": "üìã Seus agendamentos, {{user.name}}:\n\n{{#each user.agendamentos}}\nüìÖ {{data}} √†s {{horario}}\nü©∫ {{especialidade}}\nüë®‚Äç‚öïÔ∏è {{medico}}\nüìç {{local}}\n{{#if status}}‚ö†Ô∏è Status: {{status}}{{/if}}\n{{#unless @last}}---{{/unless}}\n{{/each}}\n\nüí° Para remarcar ou cancelar, entre em contato: {{props.telefone_emergencia}}"
        },
        "title": "Meus Agendamentos"
      },
      "position": {
        "x": 100,
        "y": 1080
      },
      "width": 380,
      "height": 120,
      "draggable": true,
      "selectable": true,
      "deletable": true,
      "sourcePosition": "right",
      "targetPosition": "left"
    },
    {
      "id": "informacoes_clinica",
      "type": "buttons",
      "data": {
        "final": false,
        "kind": "buttons",
        "props": {
          "buttons": [
            {
              "id": "btn_localizacao",
              "kind": "reply",
              "label": "üìç Como chegar",
              "payload": "localizacao",
              "position": 1
            },
            {
              "id": "btn_site",
              "kind": "url",
              "label": "üåê Site",
              "position": 2,
              "url": "https://clinicasaude.com.br"
            },
            {
              "id": "btn_ligar",
              "kind": "call",
              "label": "üìû Ligar agora",
              "payload": "+5511999999999",
              "position": 3
            }
          ],
          "fallback": {
            "text": "Digite:\n1Ô∏è‚É£ Para localiza√ß√£o\n2Ô∏è‚É£ Para visitar o site\n3Ô∏è‚É£ Para ligar diretamente"
          },
          "footer": "Estamos aqui para ajudar",
          "header": "Informa√ß√µes Gerais",
          "text": "‚ÑπÔ∏è {{props.clinica_nome}}\n\nüïê Hor√°rio de funcionamento:\n{{props.horario_funcionamento}}\n\nüìû Contato de emerg√™ncia:\n{{props.telefone_emergencia}}\n\nüìç Endere√ßo:\nAv. Sa√∫de, 123 - Centro\nS√£o Paulo - SP\nCEP: 01234-567\n\nO que voc√™ gostaria de saber?"
        },
        "title": "Informa√ß√µes da Cl√≠nica"
      },
      "position": {
        "x": 600,
        "y": 1080
      },
      "width": 350,
      "height": 180,
      "draggable": true,
      "selectable": true,
      "deletable": true,
      "sourcePosition": "right",
      "targetPosition": "left"
    },
    {
      "id": "timeout_handler",
      "type": "message",
      "data": {
        "final": false,
        "kind": "message",
        "props": {
          "auto_trigger": {
            "condition": "timeout",
            "delay": 300000
          },
          "parse_mode": "markdown",
          "text": "‚è∞ Parece que voc√™ ficou um tempo sem responder.\n\nüîÑ Gostaria de:\n‚Ä¢ Continuar de onde parou\n‚Ä¢ Voltar ao menu principal\n‚Ä¢ Falar com atendente\n\nDigite sua escolha ou aguarde para falar com um humano."
        },
        "title": "Tratamento de Timeout"
      },
      "position": {
        "x": 1400,
        "y": 300
      },
      "width": 320,
      "height": 120,
      "draggable": true,
      "selectable": true,
      "deletable": true,
      "sourcePosition": "right",
      "targetPosition": "left"
    },
    {
      "id": "fallback_handler",
      "type": "message",
      "data": {
        "final": false,
        "kind": "message",
        "props": {
          "escalation": {
            "action": "transfer_human",
            "message": "Transferindo para atendimento humano...",
            "trigger_at": 3
          },
          "fallback_count": "{{flow.fallback_attempts | default: 0}}",
          "max_attempts": 3,
          "text": "ü§ñ Desculpe, n√£o entendi sua resposta.\n\nüí° Algumas dicas:\n‚Ä¢ Use os bot√µes quando dispon√≠veis\n‚Ä¢ Digite n√∫meros para op√ß√µes\n‚Ä¢ Seja claro e objetivo\n\nüîÑ Vamos tentar novamente?"
        },
        "title": "Tratamento de Fallback"
      },
      "position": {
        "x": 1400,
        "y": 480
      },
      "width": 320,
      "height": 140,
      "draggable": true,
      "selectable": true,
      "deletable": true,
      "sourcePosition": "right",
      "targetPosition": "left"
    },
    {
      "id": "finalizar_atendimento",
      "type": "message",
      "data": {
        "final": true,
        "kind": "message",
        "props": {
          "parse_mode": "markdown",
          "rating": {
            "enabled": true,
            "question": "Como voc√™ avalia nosso atendimento?",
            "scale": "1-5"
          },
          "text": "Obrigado por escolher a {{props.clinica_nome}}! üôè\n\n‚≠ê Avalie nosso atendimento:\nSua opini√£o √© muito importante!\n\nüíô Cuide bem da sua sa√∫de!\n\n---\nü§ñ Atendimento autom√°tico encerrado\nüìû Para emerg√™ncias: {{props.telefone_emergencia}}"
        },
        "title": "Finaliza√ß√£o"
      },
      "position": {
        "x": 1400,
        "y": 660
      },
      "width": 320,
      "height": 140,
      "draggable": true,
      "selectable": true,
      "deletable": false,
      "sourcePosition": "right",
      "targetPosition": "left"
    }
  ]
}