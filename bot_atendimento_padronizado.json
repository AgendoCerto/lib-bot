{
  "schema": "flowkit/1.0",
  "version": {
    "id": "1.0",
    "status": "production"
  },
  "entries": [
    {
      "kind": "global_start",
      "target": "boas_vindas"
    }
  ],
  "bot": {
    "id": "barbearia-agendamento",
    "channels": ["whatsapp"]
  },
  "props": {
    "barbearia_nome": "Barbearia Premium",
    "horario_funcionamento": "Segunda a S√°bado: 9h √†s 19h",
    "telefone": "+55 11 99999-8888",
    "endereco": "Rua dos Barbeiros, 123 - Centro"
  },
  "graph": {
    "nodes": [
      {
        "id": "boas_vindas",
        "kind": "message",
        "title": "Boas-vindas",
        "props": {
          "text": "‚úÇÔ∏è Ol√°! Bem-vindo √† {{props.barbearia_nome}}!\n\nSou seu assistente virtual e vou te ajudar com o agendamento.\n\nVamos come√ßar?"
        },
        "x": 100,
        "y": 100,
        "width": 280,
        "height": 120,
        "inputs": [],
        "outputs": ["complete"]
      },
      {
        "id": "menu_servicos",
        "kind": "buttons",
        "title": "Escolher Servi√ßo",
        "props": {
          "text": "üíà Qual servi√ßo voc√™ gostaria de agendar?",
          "buttons": [
            {
              "id": "btn_corte",
              "label": "‚úÇÔ∏è Corte",
              "payload": "servico:corte",
              "kind": "reply"
            },
            {
              "id": "btn_barba",
              "label": "üßî Barba",
              "payload": "servico:barba",
              "kind": "reply"
            },
            {
              "id": "btn_completo",
              "label": "üë® Corte + Barba",
              "payload": "servico:completo",
              "kind": "reply"
            }
          ],
          "timeout": {
            "duration": 60,
            "action": "retry",
            "max_attempts": 2,
            "message": "‚è∞ Escolha um dos servi√ßos acima."
          },
          "validation": {
            "on_invalid": "retry",
            "max_attempts": 2,
            "fallback_text": "Digite:\n1 - Corte\n2 - Barba\n3 - Corte + Barba"
          }
        },
        "x": 100,
        "y": 280,
        "width": 300,
        "height": 200,
        "inputs": ["trigger"],
        "outputs": ["btn_corte", "btn_barba", "btn_completo", "invalid", "timeout"]
      },
      {
        "id": "confirmacao_agendamento",
        "kind": "confirm",
        "title": "Confirmar Agendamento",
        "props": {
          "title": "Confirmar: {{flow.servico_escolhido}}?",
          "yes": "‚úÖ Sim",
          "no": "‚ùå N√£o"
        },
        "x": 500,
        "y": 400,
        "width": 300,
        "height": 180,
        "inputs": ["trigger"],
        "outputs": ["confirmed", "cancelled", "timeout"]
      },
      {
        "id": "agendamento_sucesso",
        "kind": "message",
        "title": "Sucesso",
        "props": {
          "text": "üéâ Agendamento confirmado!\n\nServi√ßo: {{flow.servico_escolhido}}\n\nObrigado pela prefer√™ncia!"
        },
        "x": 800,
        "y": 500,
        "width": 300,
        "height": 120,
        "inputs": ["trigger"],
        "outputs": ["complete"]
      },
      {
        "id": "erro_menu_servicos",
        "kind": "message",
        "title": "Erro Menu Servi√ßos",
        "props": {
          "text": "‚ùå N√£o entendi sua resposta.\n\nüí° Use os bot√µes para escolher o servi√ßo:\n‚úÇÔ∏è Corte\nüßî Barba\nüë® Corte + Barba"
        },
        "x": 200,
        "y": 600,
        "width": 300,
        "height": 140,
        "inputs": ["trigger"],
        "outputs": ["complete"]
      },
      {
        "id": "timeout_menu_servicos",
        "kind": "message",
        "title": "Timeout Menu Servi√ßos",
        "props": {
          "text": "‚è∞ Ainda est√° a√≠?\n\nPor favor, escolha um dos servi√ßos dispon√≠veis para continuar."
        },
        "x": 600,
        "y": 600,
        "width": 300,
        "height": 140,
        "inputs": ["trigger"],
        "outputs": ["complete"]
      },
      {
        "id": "erro_confirmacao",
        "kind": "message",
        "title": "Erro Confirma√ß√£o",
        "props": {
          "text": "‚ùå Resposta n√£o reconhecida.\n\nüí° Use os bot√µes:\n‚úÖ Sim - para confirmar\n‚ùå N√£o - para cancelar"
        },
        "x": 700,
        "y": 700,
        "width": 300,
        "height": 140,
        "inputs": ["trigger"],
        "outputs": ["complete"]
      },
      {
        "id": "timeout_confirmacao",
        "kind": "message",
        "title": "Timeout Confirma√ß√£o",
        "props": {
          "text": "‚è∞ Preciso da sua confirma√ß√£o.\n\nDeseja confirmar o agendamento?"
        },
        "x": 1000,
        "y": 700,
        "width": 300,
        "height": 140,
        "inputs": ["trigger"],
        "outputs": ["complete"]
      },
      {
        "id": "agendamento_cancelado",
        "kind": "message",
        "title": "Agendamento Cancelado",
        "props": {
          "text": "‚ùå Agendamento cancelado.\n\nüòä Voc√™ pode agendar novamente quando quiser.\n\nüìû Contato: {{props.telefone}}\n\nüôè Obrigado!"
        },
        "x": 500,
        "y": 800,
        "width": 300,
        "height": 160,
        "inputs": ["trigger"],
        "outputs": ["complete"]
      }
    ],
    "edges": [
      {
        "from": "boas_vindas",
        "to": "menu_servicos",
        "label": "complete"
      },
      {
        "from": "menu_servicos",
        "to": "confirmacao_agendamento",
        "label": "btn_corte",
        "action": {
          "type": "set_flow_var",
          "key": "servico_escolhido",
          "value": "Corte de Cabelo"
        }
      },
      {
        "from": "menu_servicos",
        "to": "confirmacao_agendamento",
        "label": "btn_barba",
        "action": {
          "type": "set_flow_var",
          "key": "servico_escolhido",
          "value": "Barba"
        }
      },
      {
        "from": "menu_servicos",
        "to": "confirmacao_agendamento",
        "label": "btn_completo",
        "action": {
          "type": "set_flow_var",
          "key": "servico_escolhido",
          "value": "Corte + Barba"
        }
      },
      {
        "from": "confirmacao_agendamento",
        "to": "agendamento_sucesso",
        "label": "confirmed"
      },
      {
        "from": "confirmacao_agendamento",
        "to": "agendamento_cancelado",
        "label": "cancelled"
      },
      {
        "from": "confirmacao_agendamento",
        "to": "timeout_confirmacao",
        "label": "timeout"
      },
      {
        "from": "menu_servicos",
        "to": "erro_menu_servicos",
        "label": "invalid"
      },
      {
        "from": "menu_servicos",
        "to": "timeout_menu_servicos",
        "label": "timeout"
      },
      {
        "from": "erro_menu_servicos",
        "to": "menu_servicos",
        "label": "complete"
      },
      {
        "from": "timeout_menu_servicos",
        "to": "menu_servicos",
        "label": "complete"
      },
      {
        "from": "timeout_confirmacao",
        "to": "confirmacao_agendamento",
        "label": "complete"
      }
    ]
  }
}
